import pandas as pd\nimport numpy as np\n\nclass SimulationEngine:\n    def __init__(self, initial_balance=10000):\n        self.balance = initial_balance\n        self.trades = []\n        self.current_position = None\n\n    def open_trade(self, symbol, side, price, volume, timestamp):\n        if self.current_position:\n            print('Position already open')\n            return\n        \n        self.current_position = {\n            'symbol': symbol,\n            'side': side,\n            'open_price': price,\n            'volume': volume,\n            'open_time': timestamp\n        }\n\n    def close_trade(self, price, timestamp):\n        if not self.current_position:\n            return\n\n        pos = self.current_position\n        profit = 0\n        if pos['side'] == 'buy':\n            profit = (price - pos['open_price']) * pos['volume']\n        else:\n            profit = (pos['open_price'] - price) * pos['volume']\n\n        self.balance += profit\n        trade_record = {**pos, 'close_price': price, 'close_time': timestamp, 'profit': profit}\n        self.trades.append(trade_record)\n        self.current_position = None\n        return profit\n\n    def get_stats(self):\n        df = pd.DataFrame(self.trades)\n        if df.empty:\n            return 'No trades yet'\n        return {\n            'total_profit': df['profit'].sum(),\n            'win_rate': (df['profit'] > 0).mean(),\n            'num_trades': len(df),\n            'final_balance': self.balance\n        }